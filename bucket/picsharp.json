{
    "version": "2.2.7",
    "description": "A feature-rich, efficient and flexible cross-platform desktop image compression application.",
    "homepage": "https://github.com/AkiraBit/PicSharp",
    "license": "GPL-3.0-or-later",
    "url": "https://github.com/AkiraBit/PicSharp/releases/download/v2.2.7/PicSharp_2.2.7_x64_en-US.msi",
    "hash": "921a236bdf40dee3bf721b8f25e1034f4293877bd80533868124fb779da785c3",
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/AkiraBit/PicSharp/releases/download/v$version/PicSharp_$version_x64_en-US.msi"
    },
    "shortcuts": [
        [
            "PicSharp.exe",
            "PicSharp"
        ]
    ],
    "pre_install": [
        "$sourceDir = Join-Path $dir \"PFiles\\PicSharp\"",
        "$items = Get-ChildItem -Path $sourceDir",
        "foreach ($item in $items) {",
        "    $destinationPath = Join-Path $dir $item.Name",
        "    if (Test-Path -Path $destinationPath) {",
        "        Remove-Item -Path $destinationPath -Recurse -Force",
        "    }",
        "    Move-Item -Path $item.FullName -Destination $dir -Force",
        "}",
        "Remove-Item -Path (Join-Path $dir \"PFiles\") -Recurse -Force"
    ]
}
